    <!DOCTYPE html>
<html>
    <head>
        <title>Probabilistic Buttons</title>
        <!-- JQuery -->
        <script type="text/javascript" src="../lib/jquery.js"></script>
        <script type="text/javascript" src="../lib/snap.svg.js"></script>

        <script type="text/javascript" src="../julia.js"></script>
        <script type="text/javascript" src="../views/button.js"></script>
        <link rel="stylesheet" type="text/css" href="../julia.css"/>
        <style type="text/css">
        </style>
    </head>
<body>
<h3> Probabilistic Buttons </h3>
<div id="top_bar"></div>
<div id="demo_description">
    Demonstrates probabilistic tracking of button state, as well as selection of different feedback mechanisms.
</div>


<div id="demo_settings">
    <div>
        <label for="numSamples">number of event samples:</label>
        <input type="text" id="numSamples" value="1000"/>
    </div>
    <div>
        <label for="numAlternatives">number of alternatives to keep:</label>
        <input type="text" id="numAlternatives" value ="10"/>
    </div>
    <div>
        <label for="sampleVarianceX">sample x variance:</label>
        <input type="text" id="sampleVarianceX" value="10"/>
    </div>
    <div>
        <label for="sampleVarianceY">sample y variance:</label>
        <input type="text" id="sampleVarianceY" value="10"/>
    </div>
     <button onclick="update()">Update Settings</button>

    <div>
        feedback type:
    </div>
    <div>
        <input name="fb" type="radio" id="radio_none"/>
        <label for="radio_none">none</label>
    </div>
    <div>
        <input name="fb" type="radio" id="radio_opacity" checked="True"/>
        <label for="radio_opacity">opacity</label>
    </div>
    <div>
        <input name="fb" type="radio" id="radio_most_likely"/>
        <label for="radio_most_likely">most_likely</label>
    </div>

</div>


<table >
    <tr>
        <td>
            <svg id="demo_interface" width="320" height="200"></svg>
        </td>
        <td>
            <div id="demo_alternatives"></div>
        </td>

    </tr>

</table>

<table id="interactor_tree_table">
    <tr>
        <td>Interactor tree of main interface:</td>
    </tr>
    <tr>
        <td><div id="interactor_tree_div"/></td>
    </tr>
</table>



<script type="text/javascript">
    var julia = new Julia();
    var rootView = new ContainerView(julia);
    var buttons = [
        new Button(julia, {x: 50, y: 50, w: 100, h: 50}),
        new Button(julia, {x: 170, y: 50, w: 100, h: 50}),
        new Button(julia, {x: 50, y: 120, w: 100, h: 50}),
        new Button(julia, {x: 170, y: 120, w: 100, h: 50})
    ];
    buttons.forEach(function(button) {
        button.addClickHandler(function(){ window.alert("button at (" + button.properties.x + ", " + button.properties.y + ") clicked!")});
        rootView.addChildView(button);
    });
    julia.mediator.mediationThreshold = 0.1;
    julia.setRootView(rootView);

    var $sketch = $("#demo_interface");
    var $sketches = $("#demo_alternatives");

    var feedback = new OverlayFeedback(julia);

    $("#radio_opacity").click(function(){
        feedback = new OverlayFeedback(julia);
    });
    $("#radio_none").click(function() {
        feedback = new RootViewFeedback(julia);
    });
    $("#radio_most_likely").click(function() {
        feedback = new MostLikelyFeedback(julia);
    });
    julia.dispatchCompleted = function(new_alternatives, uiUpdated) {
        if(!uiUpdated) {
            return;
        }
        julia.dumpAlternativesAsSnap($sketches, $sketch.width(), $sketch.height(), 0.5);
        $sketch.empty();
        var merged = julia.drawFeedback($sketch, feedback);
        merged.domDump($("#interactor_tree_div"));
    };

    var mouseHook = new PMouseEventHook($sketch[0]);
    julia.addEventSource(mouseHook);

    function update() {
        julia.nSamplesPerEvent = parseInt($("#numSamples").val());
        julia.nAlternativesToKeep = parseInt($("#numAlternatives").val());
        mouseHook.variance_x_px = parseInt($("#sampleVarianceX").val());
        mouseHook.variance_y_px = parseInt($("#sampleVarianceY").val());
        julia.setRootView(rootView);
        var merged = julia.drawFeedback($sketch, feedback);
        merged.domDump($("#interactor_tree_div"));
    }
    update();

</script>
</body>
</html>